{% extends "sns/base.html" %}
{% load sns_tags %}

{% block title %}{{ profile.name }}'s SNS Activity{% endblock %}

{% block body %}
<div class="container mt-3">
  <div class="row mb-1 justify-content-center">
    <div class="col-auto">
      <h2>{{ profile.name }}'s Activity</h2>
    </div>
    <div class="col-auto">
        <a class="card-link text-info" href="{% url 'profile_edit' pk=profile.pk %}" title="Edit">
          <span class="oi oi-pencil"></span>
        </a>
    </div>
  </div>
  <div class="row justify-content-center">
  {% for sns, acct in profile.get_fields %}
  {% if acct %}
    <div class="col-md-6 col-lg-4 col-xl-4">
      <div class="card my-4">
        <h5 class="card-header"><a class="card-link text-info" href="https://{{ sns }}.com" target="_blank">{{ sns }}</a></h5>
        <div class="card-body">
          <div class="card-title text-muted">{{ acct|truncatechars:20 }}</div>
          <div class="card-text">
            <ul class="list-group list-group-flush">
            {% for d in data|get_sns:sns|dictsortreversed:'created' %}
              {% if sns == 'reddit' %}
              <li class="list-group-item small">
                <div class="row-auto"><a class="font-weight-bold" href="{{ d.url }}" target="_blank">{{ d.title }}</a> on <a class="font-weight-bold" href="https://www.reddit.com/{{ d.subreddit }}" target="_blank">{{ d.subreddit }}</a></div>
                <div class="row-auto mb-2 text-muted">{{ d.created|timesince }} ago</div>
                <div class="row-auto"><pre>{{ d.text|truncatechars_html:120|safe }}</pre></div>
              </li>
              {% elif sns == 'spotify' %}
              <li class="list-group-item small">
                <a href="{{ d.external_urls.spotify }}" target="_blank"><img src="{{ d.images.0.url}} " height="100" title="{{ d.name }}" alt="{{ d.name }}"/></a>
              </li>
              {% else %}
              <li class="list-group-item small">
                <div class="row-auto"><pre>{{ d.text|truncatechars_html:120|safe }}</pre></div>
                <div class="row-auto mb-2 text-muted">{{ d.created|timesince }} ago</div>
              </li>
              {% endif %}
            {% empty %}
              <li class="list-group-item small">No data.</li>
            {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>
  {% endif %}
  {% endfor %}
  </div>
</div>
{% endblock %}